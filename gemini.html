<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<title>Gemini Local Endpoint</title>
<style>
  body { font-family: sans-serif; padding: 20px; }
  #response { white-space: pre-wrap; }
</style>
</head>
<body>

<div id="response">Cargando...</div>

<script>
async function main() {
  const params = new URLSearchParams(window.location.search);

  const systemPrompt = params.get("prompt") || "Eres un asistente.";
  const userMessage = params.get("msg") || "Hola.";

  const apiKey = "AIzaSyAOMSB-lHfxLwlWT8HIUpoEU-hxOvahLk8";

  try {
    const response = await fetch(
      "https://generativelanguage.googleapis.com/v1beta/openai/chat/completions?key=" + apiKey,
      {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          model: "gemini-1.5-pro",
          messages: [
            { role: "system", content: systemPrompt },
            { role: "user", content: userMessage }
          ]
        })
      }
    );

    const data = await response.json();

    // Muestra solo texto limpio
    const output = data?.choices?.[0]?.message?.content || "Sin respuesta.";
    document.getElementById("response").innerText = output;

  } catch (err) {
    document.getElementById("response").innerText =
      "Error: " + err.toString();
  }
}

main();
</script>
</body>
</html>
