<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<title>Endpoint Gemini</title>
</head>
<body>

<pre id="output">Procesando...</pre>

<script>
const SYSTEM_PROMPT = `
Eres un profesor experto en entrevistas técnicas, algoritmos, 
preparación para LeetCode y Codeforces. Explicas de forma directa,
precisa y práctica.
`;

// 1. Tomar parámetro q del URL
const urlParams = new URLSearchParams(window.location.search);
const userPrompt = urlParams.get("q");

if (!userPrompt) {
  document.getElementById("output").innerText =
    "Falta parámetro: usa ?q=tu_pregunta";
} else {
  askGemini(userPrompt);
}

async function askGemini(prompt) {
  const fullMessage = SYSTEM_PROMPT + "\nUsuario: " + prompt;

  try {
    const response = await fetch(
      "https://generativelanguage.googleapis.com/v1beta/openai/chat/completions?key=AIzaSyAOMSB-AIzaSyAOMSB-lHfxLwlWT8HIUpoEU-hxOvahLk8",
      {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          model: "gemini-1.5-pro",
          messages: [
            { role: "system", content: SYSTEM_PROMPT },
            { role: "user", content: prompt }
          ]
        })
      }
    );

    const data = await response.json();
    const text =
      data?.choices?.[0]?.message?.content || "Sin respuesta del modelo";

    // 4. Imprime solo texto plano → Perfecto para App Inventor
    document.getElementById("output").innerText = text;

  } catch (e) {
    document.getElementById("output").innerText =
      "Error: " + e.message;
  }
}
</script>

</body>
</html>


